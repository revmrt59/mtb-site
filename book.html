<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mastering the Bible</title>

  <link rel="stylesheet" href="assets/css/style.css" />
</head>

<body>

  <!-- SITE HEADER -->
  <header class="site-header">
    <nav class="main-nav">
      <a href="index.html">Home</a>
      <a href="#">Resources</a>
      <a href="#">About</a>
      <a href="#">Contact</a>
    </nav>
  </header>

  <!-- BOOK NAVIGATION -->
  <nav class="book-nav" aria-label="MTB navigation">
    <div class="book-nav-row">

      <select id="bookSelect" class="book-select" aria-label="Book"></select>

      <select id="chapterSelect" class="book-select" aria-label="Chapter"></select>

      <a id="introLink" class="book-action" href="#">Book Intro</a>
      <a id="orientationLink" class="book-action" href="#">Orientation</a>
      <a id="teachingLink" class="book-action" href="#">Teaching</a>
      <a id="scriptureLink" class="book-action" href="#">Scripture</a>

    </div>
  </nav>

  <!-- DOCUMENT CONTENT -->
  <main class="doc">
    <div id="doc-target">Loadingâ€¦</div>
  </main>

  <!-- LOAD GENERATED HTML -->
  <script src="assets/js/load-doc.js"></script>

  <!-- CHAPTER NAV LOGIC -->
  <script>
    (function () {

      // =========================
      // MTB CONTENT MANIFEST (EDIT THIS AS YOU ADD MATERIAL)
      // =========================
      const MTB_CONTENT = [
        {
          name: "Titus",
          slug: "titus",
          chapters: [1, 2, 3]
        }
      ];

      const params = new URLSearchParams(window.location.search);
      const doc = params.get("doc") || "";

      const bookSelect = document.getElementById("bookSelect");
      const chapterSelect = document.getElementById("chapterSelect");

      const introLink = document.getElementById("introLink");
      const orientationLink = document.getElementById("orientationLink");
      const teachingLink = document.getElementById("teachingLink");
      const scriptureLink = document.getElementById("scriptureLink");

      if (!bookSelect || !chapterSelect || !introLink || !orientationLink || !teachingLink || !scriptureLink) return;

      function populateBooks() {
        bookSelect.innerHTML = "";

        MTB_CONTENT.forEach(book => {
          if (!book.chapters || book.chapters.length === 0) return;
          const opt = document.createElement("option");
          opt.value = book.slug;
          opt.textContent = book.name;
          bookSelect.appendChild(opt);
        });
      }

      function populateChaptersForBook(bookSlug) {
        chapterSelect.innerHTML = "";

        const book = MTB_CONTENT.find(b => b.slug === bookSlug);
        const chapters = book && book.chapters ? book.chapters : [];

        chapters.forEach(n => {
          const opt = document.createElement("option");
          opt.value = String(n);
          opt.textContent = String(n);
          chapterSelect.appendChild(opt);
        });
      }

      function getBookName(bookSlug) {
        const b = MTB_CONTENT.find(x => x.slug === bookSlug);
        return b ? b.name : bookSlug;
      }

      function setTabNames(bookSlug, chapterNum) {
        const bookName = getBookName(bookSlug);

        introLink.textContent = "What is " + bookName + " About?";
        orientationLink.textContent = "What is " + bookName + " " + chapterNum + " About?";
        teachingLink.textContent = "Understanding " + bookName + " " + chapterNum;
        scriptureLink.textContent = bookName + " " + chapterNum + " Parallel Versions";
      }

      function setLinks(bookSlug, chapterNum) {
        // Intro is always chapter 0
        introLink.href = "book.html?doc=" + encodeURIComponent(bookSlug + "-0-book-introduction.html");

        // Orientation / Teaching / Scripture use chapter N
        orientationLink.href = "book.html?doc=" + encodeURIComponent(bookSlug + "-" + chapterNum + "-chapter-orientation.html");
        teachingLink.href = "book.html?doc=" + encodeURIComponent(bookSlug + "-" + chapterNum + "-chapter-teaching.html");
        scriptureLink.href = "book.html?doc=" + encodeURIComponent(bookSlug + "-" + chapterNum + "-chapter-scripture.html");

        setTabNames(bookSlug, chapterNum);
      }

      // Infer dropdown state from current URL doc param
      const mIntro = doc.match(/^([a-z0-9-]+)-0-book-introduction\.html$/);
      const mChap = doc.match(/^([a-z0-9-]+)-(\d+)-chapter-(orientation|teaching|scripture)\.html$/);

      populateBooks();

      // Defaults if doc param missing or not matched
      let currentBook = MTB_CONTENT[0] ? MTB_CONTENT[0].slug : "titus";
      let currentChapter = (MTB_CONTENT[0] && MTB_CONTENT[0].chapters && MTB_CONTENT[0].chapters[0]) ? MTB_CONTENT[0].chapters[0] : 1;

      if (mIntro) {
        currentBook = mIntro[1];
        // If you're viewing the intro, pick the first chapter for the dropdown (no chapter 0 option)
        const b = MTB_CONTENT.find(x => x.slug === currentBook);
        currentChapter = (b &
